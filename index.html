<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tap Flight | Crypto Predictions</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #4a3aff;
            --success: #4cd964;
            --danger: #ff5a5a;
            --warning: #ff9a00;
            --bg-main: #0a0a1a;
            --bg-card: #1e1f33;
            --bg-elevated: #2a2b40;
            --text-main: #ffffff;
            --text-secondary: #a0a0c0;
            --border-color: #3a3b5a;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }
        body { background: linear-gradient(135deg, var(--bg-main) 0%, #1a1b2e 100%); color: var(--text-main); min-height: 100vh; }
        .app-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        /* Header / Wallet */
        .app-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-icon { width: 42px; height: 42px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; }
        .logo-text { font-size: 24px; font-weight: 700; background: linear-gradient(90deg, var(--primary), var(--primary-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .wallet-section { display: flex; align-items: center; gap: 15px; }
        .wallet-btn { background: linear-gradient(90deg, var(--primary), var(--primary-dark)); border: none; border-radius: 12px; padding: 10px 20px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: transform 0.2s; }
        .wallet-btn:hover { transform: translateY(-2px); }
        .network-switcher { background: var(--bg-elevated); border: 1px solid var(--border-color); border-radius: 12px; padding: 8px 15px; font-size: 14px; color: var(--text-secondary); display: flex; align-items: center; gap: 8px; cursor: pointer; }
        
        /* Main Layout */
        .prediction-layout { display: grid; grid-template-columns: 1fr 380px; gap: 20px; }
        
        /* Left: Cards Grid */
        .cards-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
        @media (max-width: 1100px) { .cards-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .prediction-layout { grid-template-columns: 1fr; } .cards-grid { grid-template-columns: 1fr; } }
        
        /* Prediction Card - PancakeSwap Style */
        .prediction-card { background: var(--bg-card); border-radius: 20px; border: 1px solid var(--border-color); overflow: hidden; transition: all 0.3s; }
        .card-header { padding: 18px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .card-status { font-size: 12px; padding: 4px 10px; border-radius: 20px; font-weight: 600; }
        .status-expired { background: rgba(160, 160, 192, 0.2); color: var(--text-secondary); }
        .status-live { background: rgba(76, 217, 100, 0.2); color: var(--success); animation: pulse 2s infinite; }
        .status-next { background: rgba(255, 154, 0, 0.2); color: var(--warning); }
        .status-later { background: rgba(108, 92, 231, 0.2); color: var(--primary); }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
        .round-id { font-size: 20px; font-weight: 700; color: var(--text-main); }
        
        .card-body { padding: 20px; }
        .price-info { text-align: center; margin-bottom: 20px; }
        .price-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 5px; }
        .price-value { font-size: 24px; font-weight: 700; margin-bottom: 5px; }
        .price-change { font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .change-up { color: var(--success); }
        .change-down { color: var(--danger); }
        
        .prediction-actions { display: flex; justify-content: space-between; gap: 15px; }
        .action-up, .action-down { flex: 1; text-align: center; }
        .direction-btn { width: 100%; padding: 14px; border: none; border-radius: 16px; font-size: 18px; font-weight: 700; color: white; cursor: pointer; margin-bottom: 10px; transition: all 0.2s; }
        .direction-btn:hover { filter: brightness(1.1); transform: translateY(-2px); }
        .btn-up { background: linear-gradient(135deg, var(--success), #2ecc71); }
        .btn-down { background: linear-gradient(135deg, var(--danger), #ff3838); }
        .payout { font-size: 16px; color: var(--text-secondary); }
        .payout-value { font-size: 24px; font-weight: 700; color: var(--text-main); margin-top: 5px; }
        
        .prize-pool { background: var(--bg-elevated); border-radius: 12px; padding: 15px; margin-top: 20px; text-align: center; border: 1px solid var(--border-color); }
        .pool-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 5px; }
        .pool-value { font-size: 20px; font-weight: 700; color: #ffd700; }
        
        /* Right: Bet Panel */
        .bet-panel { background: var(--bg-card); border-radius: 20px; border: 1px solid var(--border-color); padding: 25px; position: sticky; top: 20px; height: fit-content; }
        .panel-title { font-size: 20px; font-weight: 700; margin-bottom: 20px; text-align: center; }
        .selected-round { background: var(--bg-elevated); border-radius: 12px; padding: 15px; margin-bottom: 20px; text-align: center; border: 1px solid var(--primary); }
        .selected-direction { display: inline-block; padding: 8px 20px; border-radius: 20px; font-weight: 700; margin-top: 10px; }
        .direction-selected-up { background: rgba(76, 217, 100, 0.2); color: var(--success); }
        .direction-selected-down { background: rgba(255, 90, 90, 0.2); color: var(--danger); }
        
        .commit-section { margin-bottom: 25px; }
        .commit-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 10px; }
        .commit-input-wrapper { background: var(--bg-elevated); border: 1px solid var(--border-color); border-radius: 12px; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; }
        .commit-input { background: none; border: none; color: var(--text-main); font-size: 18px; width: 100%; outline: none; }
        .token-symbol { color: var(--text-secondary); font-weight: 600; }
        .commit-buttons { display: flex; gap: 10px; margin-top: 10px; }
        .commit-btn { flex: 1; background: var(--bg-elevated); border: 1px solid var(--border-color); border-radius: 8px; padding: 8px; color: var(--text-secondary); cursor: pointer; text-align: center; }
        .commit-btn:hover { border-color: var(--primary); color: var(--primary); }
        
        .bet-actions { display: flex; gap: 15px; }
        .action-btn { flex: 1; padding: 16px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .enter-btn { background: linear-gradient(90deg, var(--primary), var(--primary-dark)); color: white; }
        .enter-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4); }
        .later-btn { background: var(--bg-elevated); border: 1px solid var(--border-color); color: var(--text-secondary); }
        .later-btn:hover { border-color: var(--primary); color: var(--primary); }
        
        .warning-box { background: rgba(255, 154, 0, 0.1); border: 1px solid rgba(255, 154, 0, 0.3); border-radius: 12px; padding: 15px; margin-top: 25px; font-size: 13px; color: var(--warning); }
        
        /* Tutorial Section */
        .tutorial { background: var(--bg-card); border-radius: 20px; border: 1px solid var(--border-color); padding: 25px; margin-top: 20px; }
        .tutorial-title { font-size: 18px; font-weight: 700; margin-bottom: 15px; }
        .tutorial-content { font-size: 14px; color: var(--text-secondary); line-height: 1.6; }
        
        /* Connection Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); display: none; justify-content: center; align-items: center; z-index: 1000; padding: 20px; }
        .modal-content { background: var(--bg-card); border-radius: 20px; padding: 30px; width: 100%; max-width: 400px; border: 1px solid var(--border-color); }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo">
                <div class="logo-icon">TF</div>
                <div class="logo-text">Tap Flight</div>
            </div>
            <div class="wallet-section">
                <div class="network-switcher">
                    <i class="fas fa-circle"></i> BNB Chain
                </div>
                <button class="wallet-btn" id="connectWalletBtn">
                    <i class="fas fa-wallet"></i> Connect Wallet
                </button>
            </div>
        </header>

        <!-- Main Prediction Layout -->
        <div class="prediction-layout">
            <!-- Left: Prediction Cards -->
            <div class="cards-container">
                <div class="cards-grid" id="predictionCardsGrid">
                    <!-- Cards are generated by JavaScript here -->
                </div>
            </div>

            <!-- Right: Bet Panel -->
            <div class="bet-panel" id="betPanel">
                <h2 class="panel-title">Set Position</h2>
                <div class="selected-round" id="selectedRoundInfo">
                    Select a round and direction to begin
                </div>
                
                <div class="commit-section">
                    <div class="commit-label">Commit:</div>
                    <div class="commit-input-wrapper">
                        <input type="number" class="commit-input" id="commitAmount" placeholder="0.0" min="0" step="0.001" value="0.1">
                        <span class="token-symbol">BNB</span>
                    </div>
                    <div class="commit-buttons">
                        <div class="commit-btn" data-multiplier="0.25">0.25 BNB</div>
                        <div class="commit-btn" data-multiplier="0.5">0.5 BNB</div>
                        <div class="commit-btn" data-multiplier="1">1 BNB</div>
                        <div class="commit-btn" data-multiplier="2">2 BNB</div>
                    </div>
                </div>
                
                <div class="warning-box">
                    <i class="fas fa-exclamation-triangle"></i> You won't be able to remove or change your position once you enter it.
                </div>
                
                <div class="bet-actions">
                    <button class="action-btn enter-btn" id="enterPositionBtn" disabled>
                        <i class="fas fa-arrow-up"></i> Enter Position
                    </button>
                    <button class="action-btn later-btn" id="cancelBtn">
                        Later
                    </button>
                </div>
            </div>
        </div>

        <!-- Tutorial Section -->
        <div class="tutorial">
            <h3 class="tutorial-title">Quick start to Prediction</h3>
            <p class="tutorial-content">
                <strong>Welcome!</strong> Once you enter a position, you cannot cancel or adjust it. Predict whether the price of BNB will go UP or DOWN compared to the "Locked Price" when the round expires. Your payout multiplier is shown on the card. Connect your wallet to start.
            </p>
        </div>
    </div>

    <!-- Modals would go here -->
    <script>
        // ========== DATA & STATE ==========
        let userWallet = null;
        let userBalance = 5.0; // Simulated balance in BNB
        let selectedCard = null;
        let selectedDirection = null; // 'up' or 'down'
        let currentRoundId = 450306; // Starting live round ID

        // Prediction Rounds Data (matching PancakeSwap structure)
        const predictionRounds = [
            { id: 450303, status: 'Expired', lockedPrice: 879.7063, closedPrice: 879.1810, change: -0.5253, prizePool: 2.2357, payoutUp: 2.31, payoutDown: 1.76 },
            { id: 450304, status: 'Expired', lockedPrice: 879.1810, closedPrice: 879.2572, change: 0.0762, prizePool: 4.1769, payoutUp: 2.08, payoutDown: 1.92 },
            { id: 450305, status: 'Expired', lockedPrice: 879.2572, closedPrice: 879.2199, change: -0.0373, prizePool: 2.1336, payoutUp: 3.24, payoutDown: 1.45 },
            { id: 450306, status: 'Live', lockedPrice: 879.2199, lastPrice: 870.3205, change: -0.0382, prizePool: 3.0293, payoutUp: 2.06, payoutDown: 1.94 },
            { id: 450307, status: 'Next', prizePool: 0.0001, payoutUp: 0.00, payoutDown: 0.00 },
            { id: 450308, status: 'Later', entryStarts: '02:41' },
            { id: 450309, status: 'Later', entryStarts: '07:41' }
        ];

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            renderPredictionCards();
            setupEventListeners();
            simulateLivePriceMovement();
        });

        // ========== RENDER FUNCTIONS ==========
        function renderPredictionCards() {
            const grid = document.getElementById('predictionCardsGrid');
            grid.innerHTML = '';
            
            predictionRounds.forEach(round => {
                const card = document.createElement('div');
                card.className = 'prediction-card';
                card.dataset.roundId = round.id;
                
                let priceInfo = '';
                let priceChangeClass = round.change >= 0 ? 'change-up' : 'change-down';
                let changeSymbol = round.change >= 0 ? '+' : '';
                
                if (round.status === 'Expired') {
                    priceInfo = `
                        <div class="price-info">
                            <div class="price-label">Closed Price</div>
                            <div class="price-value">$${round.closedPrice.toFixed(4)}</div>
                            <div class="price-change ${priceChangeClass}">
                                <i class="fas fa-arrow-${round.change >= 0 ? 'up' : 'down'}"></i> ${changeSymbol}${round.change.toFixed(4)}
                            </div>
                        </div>
                        <div class="price-label">Locked Price:</div>
                        <div class="price-value">$${round.lockedPrice.toFixed(4)}</div>
                    `;
                } else if (round.status === 'Live') {
                    priceInfo = `
                        <div class="price-info">
                            <div class="price-label">Last Price</div>
                            <div class="price-value" id="livePrice-${round.id}">$${round.lastPrice.toFixed(4)}</div>
                            <div class="price-change ${priceChangeClass}">
                                <i class="fas fa-arrow-${round.change >= 0 ? 'up' : 'down'}"></i> ${changeSymbol}${round.change.toFixed(4)}
                            </div>
                        </div>
                        <div class="price-label">Locked Price:</div>
                        <div class="price-value">$${round.lockedPrice.toFixed(4)}</div>
                    `;
                } else if (round.status === 'Next') {
                    priceInfo = `
                        <div class="price-info">
                            <div class="price-label">Locked Price will be set</div>
                            <div class="price-value">-</div>
                        </div>
                    `;
                } else if (round.status === 'Later') {
                    priceInfo = `
                        <div class="price-info">
                            <div class="price-label">Entry starts</div>
                            <div class="price-value">~${round.entryStarts}</div>
                        </div>
                    `;
                }
                
                let actionButtons = '';
                if (round.status === 'Live' || round.status === 'Next') {
                    actionButtons = `
                        <div class="prediction-actions">
                            <div class="action-up">
                                <button class="direction-btn btn-up" data-direction="up" data-round="${round.id}">Up</button>
                                <div class="payout">Payout</div>
                                <div class="payout-value">${round.payoutUp.toFixed(2)}x</div>
                            </div>
                            <div class="action-down">
                                <button class="direction-btn btn-down" data-direction="down" data-round="${round.id}">Down</button>
                                <div class="payout">Payout</div>
                                <div class="payout-value">${round.payoutDown.toFixed(2)}x</div>
                            </div>
                        </div>
                    `;
                } else {
                    actionButtons = `
                        <div class="prediction-actions">
                            <div class="action-up">
                                <div style="padding: 14px; opacity: 0.5; border-radius: 16px; background: #2a2b40; margin-bottom: 10px;">Up</div>
                                <div class="payout">Payout</div>
                                <div class="payout-value">${round.payoutUp ? round.payoutUp.toFixed(2) + 'x' : '-'}</div>
                            </div>
                            <div class="action-down">
                                <div style="padding: 14px; opacity: 0.5; border-radius: 16px; background: #2a2b40; margin-bottom: 10px;">Down</div>
                                <div class="payout">Payout</div>
                                <div class="payout-value">${round.payoutDown ? round.payoutDown.toFixed(2) + 'x' : '-'}</div>
                            </div>
                        </div>
                    `;
                }
                
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-status status-${round.status.toLowerCase()}">${round.status}</div>
                        <div class="round-id">#${round.id}</div>
                    </div>
                    <div class="card-body">
                        ${priceInfo}
                        ${actionButtons}
                        <div class="prize-pool">
                            <div class="pool-label">Prize Pool:</div>
                            <div class="pool-value">${round.prizePool ? round.prizePool.toFixed(4) + ' BNB' : '<0.0001 BNB'}</div>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // ========== EVENT HANDLERS ==========
        function setupEventListeners() {
            // Connect Wallet
            document.getElementById('connectWalletBtn').addEventListener('click', function() {
                if (!userWallet) {
                    // Simulate wallet connection
                    userWallet = '0x' + Math.random().toString(16).substr(2, 10) + '...' + Math.random().toString(16).substr(2, 6);
                    this.innerHTML = `<i class="fas fa-wallet"></i> ${userWallet}`;
                    updateBetPanelState();
                } else {
                    userWallet = null;
                    this.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                    selectedCard = null;
                    selectedDirection = null;
                    updateBetPanelState();
                }
            });

            // Card Selection (Up/Down buttons)
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('direction-btn')) {
                    if (!userWallet) {
                        alert('Please connect your wallet first!');
                        return;
                    }
                    
                    const roundId = parseInt(e.target.dataset.round);
                    const direction = e.target.dataset.direction;
                    
                    // Update selection
                    selectedCard = roundId;
                    selectedDirection = direction;
                    
                    // Update UI
                    document.querySelectorAll('.direction-btn').forEach(btn => {
                        btn.style.boxShadow = 'none';
                        btn.style.opacity = '1';
                    });
                    e.target.style.boxShadow = `0 0 0 3px ${direction === 'up' ? 'rgba(76, 217, 100, 0.5)' : 'rgba(255, 90, 90, 0.5)'}`;
                    e.target.style.opacity = '0.9';
                    
                    updateBetPanelState();
                }
            });

            // Quick commit amount buttons
            document.querySelectorAll('.commit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const multiplier = parseFloat(this.dataset.multiplier);
                    document.getElementById('commitAmount').value = multiplier.toFixed(multiplier >= 1 ? 0 : 2);
                    validateCommitAmount();
                });
            });

            // Commit amount input
            document.getElementById('commitAmount').addEventListener('input', validateCommitAmount);

            // Enter Position button
            document.getElementById('enterPositionBtn').addEventListener('click', function() {
                if (!selectedCard || !selectedDirection || !userWallet) return;
                
                const amount = parseFloat(document.getElementById('commitAmount').value);
                if (amount <= 0 || amount > userBalance) {
                    alert(`Invalid amount. Your balance: ${userBalance.toFixed(2)} BNB`);
                    return;
                }
                
                // Find selected round data
                const round = predictionRounds.find(r => r.id === selectedCard);
                const payout = selectedDirection === 'up' ? round.payoutUp : round.payoutDown;
                const potentialWin = amount * payout;
                
                // Simulate transaction
                if (confirm(`Enter ${amount} BNB on ${selectedDirection.toUpperCase()} for Round #${selectedCard}?\nPotential payout: ${potentialWin.toFixed(4)} BNB (${payout}x)`)) {
                    alert('Position entered successfully!');
                    userBalance -= amount;
                    
                    // Reset selection
                    selectedCard = null;
                    selectedDirection = null;
                    document.querySelectorAll('.direction-btn').forEach(btn => {
                        btn.style.boxShadow = 'none';
                        btn.style.opacity = '1';
                    });
                    document.getElementById('commitAmount').value = '0.1';
                    updateBetPanelState();
                }
            });

            // Later button
            document.getElementById('cancelBtn').addEventListener('click', function() {
                selectedCard = null;
                selectedDirection = null;
                document.querySelectorAll('.direction-btn').forEach(btn => {
                    btn.style.boxShadow = 'none';
                    btn.style.opacity = '1';
                });
                updateBetPanelState();
            });
        }

        // ========== UI UPDATES ==========
        function updateBetPanelState() {
            const enterBtn = document.getElementById('enterPositionBtn');
            const selectedInfo = document.getElementById('selectedRoundInfo');
            
            if (selectedCard && selectedDirection) {
                const round = predictionRounds.find(r => r.id === selectedCard);
                const payout = selectedDirection === 'up' ? round.payoutUp : round.payoutDown;
                
                selectedInfo.innerHTML = `
                    <div>Round <strong>#${selectedCard}</strong></div>
                    <div>Direction: <span class="selected-direction direction-selected-${selectedDirection}">${selectedDirection.toUpperCase()}</span></div>
                    <div style="margin-top: 10px; font-size: 14px; color: var(--text-secondary);">Payout: <strong>${payout.toFixed(2)}x</strong></div>
                `;
                
                enterBtn.disabled = false;
                enterBtn.innerHTML = `<i class="fas fa-arrow-${selectedDirection}"></i> Enter ${selectedDirection.toUpperCase()} Position`;
            } else {
                selectedInfo.textContent = 'Select a round and direction to begin';
                enterBtn.disabled = true;
                enterBtn.innerHTML = `<i class="fas fa-arrow-up"></i> Enter Position`;
            }
        }

        function validateCommitAmount() {
            const amount = parseFloat(document.getElementById('commitAmount').value) || 0;
            const enterBtn = document.getElementById('enterPositionBtn');
            
            if (amount <= 0) {
                enterBtn.disabled = true;
            } else if (amount > userBalance) {
                enterBtn.disabled = true;
                // You could show an error tooltip here
            } else if (selectedCard && selectedDirection) {
                enterBtn.disabled = false;
            }
        }

        // ========== LIVE PRICE SIMULATION ==========
        function simulateLivePriceMovement() {
            const liveRound = predictionRounds.find(r => r.status === 'Live');
            if (!liveRound) return;
            
            const priceElement = document.getElementById(`livePrice-${liveRound.id}`);
            if (!priceElement) return;
            
            let currentPrice = liveRound.lastPrice;
            
            // Simulate price changes every 3 seconds
            setInterval(() => {
                // Random small price movement
                const change = (Math.random() - 0.5) * 0.3;
                currentPrice += change;
                
                // Update display
                priceElement.textContent = `$${currentPrice.toFixed(4)}`;
                
                // You could also update the change indicator here
            }, 3000);
        }
    </script>
</body>
</html>