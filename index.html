<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #1c1c1e;
            --tg-theme-text-color: #ffffff;
            --tg-theme-button-color: #3390ec;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #2c2c2e;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', system-ui, sans-serif;
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            -webkit-tap-highlight-color: transparent;
        }
        
        /* –°—Ç–∏–ª—å –∫–∞–∫ –≤ Telegram Wallet */
        .telegram-card {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0px 4px 24px rgba(0, 0, 0, 0.25);
        }
        
        .telegram-gradient-bg {
            background: linear-gradient(180deg, #1c1c1e 0%, #2c2c2e 100%);
        }
        
        .telegram-button {
            background: var(--tg-theme-button-color);
            border-radius: 12px;
            transition: all 0.2s ease;
        }
        
        .telegram-button:hover {
            opacity: 0.9;
            transform: scale(0.98);
        }
        
        .telegram-button:active {
            transform: scale(0.96);
        }
        
        /* –¶–≤–µ—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ UP/DOWN */
        .up-button-telegram {
            background: linear-gradient(180deg, #31D0AA 0%, #2BC48A 100%);
            border: 1px solid rgba(49, 208, 170, 0.2);
        }
        
        .down-button-telegram {
            background: linear-gradient(180deg, #ED4B9E 0%, #E93C8F 100%);
            border: 1px solid rgba(237, 75, 158, 0.2);
        }
        
        /* –ë–µ–π–¥–∂–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ */
        .live-badge-telegram {
            background: linear-gradient(180deg, #ED4B9E 0%, #E93C8F 100%);
            color: white;
        }
        
        .next-badge-telegram {
            background: linear-gradient(180deg, #31D0AA 0%, #2BC48A 100%);
            color: white;
        }
        
        .later-badge-telegram {
            background: #5D5D5D;
            color: white;
        }
        
        .prev-badge-telegram {
            background: #4A4A4A;
            color: white;
        }
        
        .my-bet-badge-telegram {
            background: linear-gradient(180deg, #3390ec 0%, #1c7cd6 100%);
            color: white;
        }
        
        /* –¢–∞–π–º–µ—Ä */
        .timer-container {
            background: linear-gradient(135deg, #3390ec 0%, #1c7cd6 100%);
            border-radius: 16px;
            padding: 12px 16px;
            margin: 12px 16px;
            box-shadow: 0 8px 32px rgba(51, 144, 236, 0.3);
        }
        
        .timer-digit {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 8px 10px;
            font-variant-numeric: tabular-nums;
        }
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–∞—Ä */
        .pair-button-compact {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            transition: all 0.2s ease;
            cursor: pointer;
            padding: 8px 10px;
            min-width: 0;
        }
        
        .pair-button-compact:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }
        
        .pair-button-compact.selected {
            background: var(--tg-theme-button-color);
            border-color: var(--tg-theme-button-color);
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */
        .progress-bar-telegram {
            background: rgba(255, 255, 255, 0.1);
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #31D0AA 0%, #ED4B9E 100%);
            transition: width 1s linear;
        }
        
        /* –°–∫—Ä–æ–ª–ª */
        .scroll-container {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .scroll-container::-webkit-scrollbar {
            display: none;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal-overlay-telegram {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ Telegram */
        .tg-safe-area {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ */
        .floating-bottom-telegram {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--tg-theme-secondary-bg-color);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0px -4px 24px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }
        
        /* –¶–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞ */
        .text-price-up {
            color: #31D0AA;
        }
        
        .text-price-down {
            color: #ED4B9E;
        }
        
        .text-muted {
            color: #8E8E93;
        }
        
        /* –ò–∫–æ–Ω–∫–∏ –¥–ª—è –∫—Ä–∏–ø—Ç—ã */
        .crypto-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .btc-icon { background: #F7931A; color: white; }
        .eth-icon { background: #627EEA; color: white; }
        .bnb-icon { background: #F0B90B; color: #000; }
        .ton-icon { background: #0098EA; color: white; }
    </style>
</head>
<body class="tg-safe-area">
    <div id="root"></div>
    
    <script>
        const { useState, useEffect, useCallback, useMemo } = React;
        
        // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
        const TRANSLATIONS = {
            en: {
                title: "TON Prediction",
                subtitle: "Predict crypto price movements",
                balance: "Balance",
                selectRound: "Selected: Round #",
                swipeHint: "Swipe left/right to view other rounds",
                addBalance: "üíé Add 100 TON",
                roundStatus: {
                    prev: "PREV",
                    live: "LIVE",
                    next: "Next",
                    later: "Later"
                },
                betButtons: {
                    up: "UP",
                    down: "DOWN",
                    enterUp: "Enter UP",
                    enterDown: "Enter DOWN",
                    payout: "Payout",
                    poolCloses: "Pool closes in",
                    entryStarts: "Entry starts"
                },
                betModal: {
                    title: "Round #",
                    predict: "Predict",
                    amount: "Amount",
                    balance: "Balance",
                    potentialPayout: "Potential Payout",
                    confirm: "Confirm",
                    cancel: "Cancel",
                    myBet: "My Bet:",
                    cantCancel: "Cannot cancel bet once placed"
                },
                priceLabels: {
                    lockedPrice: "Locked Price",
                    prizePool: "Prize Pool",
                    lastPrice: "Last Price"
                },
                alerts: {
                    betPlaced: "Bet placed!",
                    balanceAdded: "Balance topped up by 100 TON!",
                    oneBetOnly: "You can only place one bet per round!",
                    alreadyBet: "You already placed a bet in this round",
                    insufficientBalance: "Insufficient balance",
                    amountRange: "Please enter amount between"
                },
                loading: "Loading prediction rounds...",
                timer: {
                    nextRound: "Next Round In",
                    liveRound: "Round Ends In"
                }
            },
            ru: {
                title: "–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è TON",
                subtitle: "–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–π—Ç–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω",
                balance: "–ë–∞–ª–∞–Ω—Å",
                selectRound: "–í—ã–±—Ä–∞–Ω–æ: –†–∞—É–Ω–¥ #",
                swipeHint: "–°–≤–∞–π–ø–∞–π—Ç–µ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ",
                addBalance: "üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å 100 TON",
                roundStatus: {
                    prev: "–ü–†–û–®–õ–´–ô",
                    live: "–í –≠–§–ò–†–ï",
                    next: "–°–ª–µ–¥—É—é—â–∏–π",
                    later: "–ü–æ–∑–∂–µ"
                },
                betButtons: {
                    up: "–í–í–ï–†–•",
                    down: "–í–ù–ò–ó",
                    enterUp: "–°—Ç–∞–≤–∫–∞ –í–í–ï–†–•",
                    enterDown: "–°—Ç–∞–≤–∫–∞ –í–ù–ò–ó",
                    payout: "–í—ã–ø–ª–∞—Ç–∞",
                    poolCloses: "–°—Ç–∞–≤–∫–∏ –∑–∞–∫—Ä–æ—é—Ç—Å—è —á–µ—Ä–µ–∑",
                    entryStarts: "–ù–∞—á–∞–ª–æ –ø—Ä–∏—ë–º–∞"
                },
                betModal: {
                    title: "–†–∞—É–Ω–¥ #",
                    predict: "–ü—Ä–æ–≥–Ω–æ–∑",
                    amount: "–°—É–º–º–∞",
                    balance: "–ë–∞–ª–∞–Ω—Å",
                    potentialPayout: "–í–æ–∑–º–æ–∂–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à",
                    confirm: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
                    cancel: "–û—Ç–º–µ–Ω–∞",
                    myBet: "–ú–æ—è —Å—Ç–∞–≤–∫–∞:",
                    cantCancel: "–°—Ç–∞–≤–∫—É –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å"
                },
                priceLabels: {
                    lockedPrice: "–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞",
                    prizePool: "–ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥",
                    lastPrice: "–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞"
                },
                alerts: {
                    betPlaced: "–°—Ç–∞–≤–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞!",
                    balanceAdded: "–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω!",
                    oneBetOnly: "–¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—Ç–∞–≤–∫–∞ –Ω–∞ —Ä–∞—É–Ω–¥!",
                    alreadyBet: "–í—ã —É–∂–µ —Å–¥–µ–ª–∞–ª–∏ —Å—Ç–∞–≤–∫—É",
                    insufficientBalance: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤",
                    amountRange: "–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –æ—Ç"
                },
                loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",
                timer: {
                    nextRound: "–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑",
                    liveRound: "–†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —á–µ—Ä–µ–∑"
                }
            }
        };
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            MIN_BET: 1,
            MAX_BET: 1000,
            ROUND_DURATION: 300, // 5 –º–∏–Ω—É—Ç = 300 —Å–µ–∫—É–Ω–¥
            ENTRY_DURATION: 300, // 5 –º–∏–Ω—É—Ç –¥–ª—è —Å—Ç–∞–≤–æ–∫
            COMMISSION: 0.03, // 3%
            INITIAL_ROUND_ID: 450100
        };
        
        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–∞–π–º–µ—Ä–∞
        function RoundTimer({ timeLeft, t, isLive }) {
            const formatTime = (seconds) => {
                if (seconds < 0) return "00:00";
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };
            
            return React.createElement('div', { className: "timer-container" },
                React.createElement('div', { className: "flex justify-between items-center" },
                    React.createElement('div', null,
                        React.createElement('div', { className: "text-white text-sm font-medium" },
                            isLive ? t.timer.liveRound : t.timer.nextRound
                        )
                    ),
                    React.createElement('div', { className: "flex items-center gap-1" },
                        formatTime(timeLeft).split('').map((char, index) => 
                            char === ':' ? 
                                React.createElement('div', { key: index, className: "text-white text-xl font-bold mx-1" }, ":") :
                                React.createElement('div', { 
                                    key: index,
                                    className: "timer-digit text-white text-xl font-bold"
                                }, char)
                        )
                    )
                )
            );
        }
        
        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–∞—Ä (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–π)
        function PairsHeader({ prices, selectedPair, onSelectPair, language }) {
            const pairs = [
                { 
                    symbol: 'BTC', 
                    name: language === 'ru' ? '–ë–∏—Ç–∫–æ–∏–Ω' : 'Bitcoin', 
                    price: prices.BTC || 89188.74,
                    change: 2.34,
                    icon: '‚Çø'
                },
                { 
                    symbol: 'ETH', 
                    name: language === 'ru' ? '–≠—Ñ–∏—Ä–∏—É–º' : 'Ethereum', 
                    price: prices.ETH || 2950.49,
                    change: -1.27,
                    icon: 'Œû'
                },
                { 
                    symbol: 'BNB', 
                    name: language === 'ru' ? '–ë–∏–Ω–∞–Ω—Å' : 'Binance', 
                    price: prices.BNB || 886.87,
                    change: 0.89,
                    icon: '‚ìÉ'
                },
                { 
                    symbol: 'TON', 
                    name: language === 'ru' ? '–¢–æ–Ω' : 'Toncoin', 
                    price: prices.TON || 6.85, // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞ TON
                    change: 3.45,
                    icon: '‚ìâ'
                }
            ];
            
            return React.createElement('div', { className: "px-4 py-3" },
                React.createElement('div', { className: "grid grid-cols-4 gap-2" },
                    pairs.map(pair => 
                        React.createElement('button', {
                            key: pair.symbol,
                            className: `pair-button-compact flex flex-col items-center justify-center transition-all ${selectedPair === pair.symbol ? 'selected' : ''}`,
                            onClick: () => onSelectPair(pair.symbol)
                        },
                            React.createElement('div', { className: "flex items-center justify-center gap-1.5 mb-1" },
                                React.createElement('div', { className: `crypto-icon ${pair.symbol.toLowerCase()}-icon` },
                                    pair.icon
                                ),
                                React.createElement('div', { className: "text-sm font-medium" }, pair.symbol)
                            ),
                            React.createElement('div', { className: "text-base font-bold text-white mb-0.5" },
                                `$${pair.price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
                            ),
                            React.createElement('div', { 
                                className: `text-xs font-medium ${pair.change >= 0 ? 'text-price-up' : 'text-price-down'}`
                            },
                                pair.change >= 0 ? `+${pair.change.toFixed(2)}%` : `${pair.change.toFixed(2)}%`
                            )
                        )
                    )
                )
            );
        }
        
        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—É–Ω–¥–∞
        function PredictionCard({ round, onBet, balance, isSelected, onSelect, t, userBets, currentPair }) {
            const [timeLeft, setTimeLeft] = useState(0);
            const [progress, setProgress] = useState(0);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å—Ç–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ
            const userBet = userBets?.find(bet => bet.roundId === round.id);
            const hasUserBet = !!userBet;
            
            // –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è LIVE —Ä–∞—É–Ω–¥–æ–≤)
            useEffect(() => {
                if (!round || round.status !== 'live') return;
                
                const updateTime = () => {
                    const now = Date.now();
                    const liveTimeLeft = Math.max(0, round.endTime - now);
                    setTimeLeft(Math.floor(liveTimeLeft / 1000));
                    setProgress(100 - (liveTimeLeft / (round.endTime - round.startTime)) * 100);
                };
                
                updateTime();
                const interval = setInterval(updateTime, 1000);
                return () => clearInterval(interval);
            }, [round]);
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            const formatTime = (seconds) => {
                if (seconds < 0) return "00:00";
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–Ω–µ–≥
            const formatCurrency = (value) => {
                if (value >= 1000) return `${(value/1000).toFixed(2)}K`;
                return value.toFixed(4);
            };
            
            if (!round) return null;
            
            // –î–ª—è PREV —Ä–∞—É–Ω–¥–æ–≤: —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç—Å—è
            const getPrevRoundResult = (round) => {
                if (round.status !== 'prev') return null;
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
                const userBetForRound = userBets?.find(bet => bet.roundId === round.id);
                if (userBetForRound) {
                    return {
                        result: userBetForRound.finalResult,
                        userWon: userBetForRound.won,
                        userBetAmount: userBetForRound.amount
                    };
                }
                
                // –ò–Ω–∞—á–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —Ü–µ–Ω–µ
                const priceChange = round.closedPrice - round.lockedPrice;
                const isUp = priceChange >= 0;
                return {
                    result: isUp ? 'up' : 'down',
                    userWon: false,
                    userBetAmount: 0
                };
            };
            
            // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤—ã–ø–ª–∞—Ç (–¥–ª—è PREV —Ä–∞—É–Ω–¥–æ–≤ –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã)
            const getPayouts = (round) => {
                if (round.status === 'prev') {
                    // –î–ª—è PREV —Ä–∞—É–Ω–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                    return {
                        payoutUp: round.frozenPayoutUp || (round.prizePoolUp > 0 
                            ? (round.prizePool / round.prizePoolUp * (1 - CONFIG.COMMISSION)).toFixed(2)
                            : '1.00'),
                        payoutDown: round.frozenPayoutDown || (round.prizePoolDown > 0 
                            ? (round.prizePool / round.prizePoolDown * (1 - CONFIG.COMMISSION)).toFixed(2)
                            : '1.00')
                    };
                } else {
                    // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
                    return {
                        payoutUp: round.prizePoolUp > 0 
                            ? (round.prizePool / round.prizePoolUp * (1 - CONFIG.COMMISSION)).toFixed(2)
                            : '1.00',
                        payoutDown: round.prizePoolDown > 0 
                            ? (round.prizePool / round.prizePoolDown * (1 - CONFIG.COMMISSION)).toFixed(2)
                            : '1.00'
                    };
                }
            };
            
            const payouts = getPayouts(round);
            
            // –†–µ–Ω–¥–µ—Ä –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞
            const renderContent = () => {
                switch(round.status) {
                    case 'prev':
                        return renderPrevRound();
                    case 'live':
                        return renderLiveRound();
                    case 'next':
                        return renderNextRound();
                    case 'later':
                        return renderLaterRound();
                    default:
                        return null;
                }
            };
            
            // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Ä–∞—É–Ω–¥ (–∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–π)
            const renderPrevRound = () => {
                const priceChange = round.closedPrice - round.lockedPrice;
                const isUp = priceChange >= 0;
                const prevResult = getPrevRoundResult(round);
                
                return React.createElement('div', { className: "p-4" },
                    // –ù–æ–º–µ—Ä –∏ —Å—Ç–∞—Ç—É—Å
                    React.createElement('div', { className: "flex justify-between items-center mb-4" },
                        React.createElement('div', null,
                            React.createElement('div', { className: "text-lg font-semibold text-white" }, `#${round.id}`),
                            React.createElement('div', { className: "text-sm text-muted" }, `${currentPair}/USD`)
                        ),
                        React.createElement('div', { className: "prev-badge-telegram text-xs font-bold px-3 py-1.5 rounded-full" }, t.roundStatus.prev)
                    ),
                    
                    // –¶–µ–Ω–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('div', { className: "text-2xl font-bold text-white mb-2" },
                            `$${round.closedPrice.toFixed(2)}`
                        ),
                        React.createElement('div', { className: `text-base font-medium ${isUp ? 'text-price-up' : 'text-price-down'}` },
                            `${isUp ? 'üìà' : 'üìâ'} ${isUp ? '+' : ''}${((priceChange/round.lockedPrice)*100).toFixed(2)}%`
                        )
                    ),
                    
                    // Locked Price
                    React.createElement('div', { className: "flex justify-between text-sm mb-2" },
                        React.createElement('span', { className: "text-muted" }, t.priceLabels.lockedPrice),
                        React.createElement('span', { className: "font-medium text-white" }, `$${round.lockedPrice.toFixed(2)}`)
                    ),
                    
                    // Prize Pool
                    React.createElement('div', { className: "flex justify-between text-sm mb-4" },
                        React.createElement('span', { className: "text-muted" }, t.priceLabels.prizePool),
                        React.createElement('span', { className: "font-medium text-white" }, `${formatCurrency(round.prizePool)} ${currentPair}`)
                    ),
                    
                    // –†–µ–∑—É–ª—å—Ç–∞—Ç (–∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–π)
                    React.createElement('div', { className: "flex gap-2" },
                        React.createElement('div', { 
                            className: `flex-1 text-center py-3 rounded-xl ${isUp ? 'up-button-telegram text-white' : 'bg-opacity-10 bg-white text-muted opacity-60'}`
                        },
                            React.createElement('div', { className: "font-bold text-lg" }, t.betButtons.up),
                            React.createElement('div', { className: "text-sm opacity-90" }, `${payouts.payoutUp}x ${t.betButtons.payout}`),
                            isUp && React.createElement('div', { className: "text-xs mt-1 font-bold" }, "WON")
                        ),
                        React.createElement('div', { 
                            className: `flex-1 text-center py-3 rounded-xl ${!isUp ? 'down-button-telegram text-white' : 'bg-opacity-10 bg-white text-muted opacity-60'}`
                        },
                            React.createElement('div', { className: "font-bold text-lg" }, t.betButtons.down),
                            React.createElement('div', { className: "text-sm opacity-90" }, `${payouts.payoutDown}x ${t.betButtons.payout}`),
                            !isUp && React.createElement('div', { className: "text-xs mt-1 font-bold" }, "WON")
                        )
                    ),
                    
                    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –±—ã–ª–∞
                    prevResult.userBetAmount > 0 && React.createElement('div', { 
                        className: `mt-3 px-3 py-2 rounded-lg text-center ${prevResult.userWon ? 'bg-green-500 bg-opacity-20 text-green-400' : 'bg-red-500 bg-opacity-20 text-red-400'}`
                    },
                        React.createElement('div', { className: "text-sm font-medium" },
                            `Your bet: ${prevResult.userBetAmount} ${currentPair} ${prevResult.result === 'up' ? '‚Üë' : '‚Üì'}`
                        ),
                        React.createElement('div', { className: "text-xs mt-1" },
                            prevResult.userWon ? `You won ${(prevResult.userBetAmount * (prevResult.result === 'up' ? parseFloat(payouts.payoutUp) : parseFloat(payouts.payoutDown))).toFixed(2)} ${currentPair}!` : "You lost this round"
                        )
                    )
                );
            };
            
            // LIVE —Ä–∞—É–Ω–¥
            const renderLiveRound = () => {
                const currentPrice = round.currentPrice || round.lockedPrice;
                const priceChange = currentPrice - round.lockedPrice;
                const isUp = priceChange >= 0;
                
                return React.createElement('div', { className: "p-4" },
                    // –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä –∏ –Ω–æ–º–µ—Ä
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('div', { className: "progress-bar-telegram mb-3" }, 
                            React.createElement('div', { 
                                className: "progress-fill", 
                                style: { width: `${progress}%` } 
                            })
                        ),
                        React.createElement('div', { className: "flex justify-between items-center" },
                            React.createElement('div', null,
                                React.createElement('div', { className: "text-lg font-semibold text-white" }, `#${round.id}`),
                                React.createElement('div', { className: "text-sm text-muted" }, `${currentPair}/USD`)
                            ),
                            React.createElement('div', { className: "live-badge-telegram text-xs font-bold px-3 py-1.5 rounded-full" }, t.roundStatus.live)
                        )
                    ),
                    
                    // –¶–µ–Ω–∞ –∏ —Ç–∞–π–º–µ—Ä
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('div', { className: "flex justify-between items-center mb-3" },
                            React.createElement('div', { className: "text-2xl font-bold text-white" },
                                `$${currentPrice.toFixed(2)}`
                            ),
                            React.createElement('div', { className: "text-lg font-bold text-white bg-opacity-10 bg-white px-3 py-2 rounded-lg" },
                                formatTime(timeLeft)
                            )
                        ),
                        React.createElement('div', { className: `text-base font-medium ${isUp ? 'text-price-up' : 'text-price-down'}` },
                            `${isUp ? '‚Üë' : '‚Üì'} $${Math.abs(priceChange).toFixed(2)}`
                        )
                    ),
                    
                    // Locked Price
                    React.createElement('div', { className: "flex justify-between text-sm mb-3" },
                        React.createElement('span', { className: "text-muted" }, t.priceLabels.lockedPrice),
                        React.createElement('span', { className: "font-medium text-white" }, `$${round.lockedPrice.toFixed(2)}`)
                    ),
                    
                    // Prize Pool
                    React.createElement('div', { className: "flex justify-between text-sm mb-6" },
                        React.createElement('span', { className: "text-muted" }, t.priceLabels.prizePool),
                        React.createElement('span', { className: "font-medium text-white" }, `${formatCurrency(round.prizePool)} ${currentPair}`)
                    ),
                    
                    // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
                    React.createElement('div', { className: "flex gap-3" },
                        React.createElement('div', { 
                            className: `flex-1 text-center py-3 rounded-xl ${isUp ? 'up-button-telegram text-white' : 'bg-opacity-10 bg-white text-muted'}`
                        },
                            React.createElement('div', { className: "font-bold text-lg" }, t.betButtons.up),
                            React.createElement('div', { className: "text-sm opacity-90" }, `${payouts.payoutUp}x ${t.betButtons.payout}`)
                        ),
                        React.createElement('div', { 
                            className: `flex-1 text-center py-3 rounded-xl ${!isUp ? 'down-button-telegram text-white' : 'bg-opacity-10 bg-white text-muted'}`
                        },
                            React.createElement('div', { className: "font-bold text-lg" }, t.betButtons.down),
                            React.createElement('div', { className: "text-sm opacity-90" }, `${payouts.payoutDown}x ${t.betButtons.payout}`)
                        )
                    )
                );
            };
            
            // NEXT —Ä–∞—É–Ω–¥
            const renderNextRound = () => {
                const isBetDisabled = hasUserBet;
                
                return React.createElement('div', { className: "p-4" },
                    // –ù–æ–º–µ—Ä –∏ —Å—Ç–∞—Ç—É—Å
                    React.createElement('div', { className: "flex justify-between items-center mb-4" },
                        React.createElement('div', null,
                            React.createElement('div', { className: "text-lg font-semibold text-white" }, `#${round.id}`),
                            React.createElement('div', { className: "text-sm text-muted" }, `${currentPair}/USD`)
                        ),
                        React.createElement('div', { className: "next-badge-telegram text-xs font-bold px-3 py-1.5 rounded-full" }, t.roundStatus.next)
                    ),
                    
                    // Prize Pool
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('div', { className: "text-sm text-muted mb-2" }, `${t.priceLabels.prizePool}:`),
                        React.createElement('div', { className: "text-2xl font-bold text-white" },
                            `${formatCurrency(round.prizePool)} ${currentPair}`
                        )
                    ),
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–æ—é —Å—Ç–∞–≤–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
                    hasUserBet && React.createElement('div', { className: "mb-4" },
                        React.createElement('div', { className: "my-bet-badge-telegram text-xs font-bold px-4 py-3 rounded-xl text-center" },
                            React.createElement('div', { className: "text-sm" }, t.betModal.myBet),
                            React.createElement('div', { className: "font-bold text-xl mt-1 mb-2" }, `${userBet.amount} ${currentPair}`),
                            React.createElement('div', { className: "text-sm opacity-90" }, 
                                `${userBet.side === 'up' ? t.betButtons.up : t.betButtons.down} ‚Ä¢ ${userBet.side === 'up' ? payouts.payoutUp : payouts.payoutDown}x`
                            )
                        ),
                        React.createElement('div', { className: "text-xs text-muted text-center mt-2" }, t.betModal.cantCancel)
                    ),
                    
                    // –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞–≤–æ–∫
                    React.createElement('div', { className: "flex gap-3 mb-4" },
                        React.createElement('button', {
                            className: `flex-1 up-button-telegram text-white py-4 rounded-xl font-bold transition-all ${isBetDisabled ? 'opacity-50 cursor-not-allowed' : 'hover:opacity-90 active:scale-95'}`,
                            onClick: () => !isBetDisabled && onBet(round.id, 'up'),
                            disabled: isBetDisabled
                        },
                            React.createElement('div', { className: "text-lg" }, t.betButtons.enterUp),
                            React.createElement('div', { className: "text-sm opacity-90 mt-1" }, `${payouts.payoutUp}x ${t.betButtons.payout}`)
                        ),
                        React.createElement('button', {
                            className: `flex-1 down-button-telegram text-white py-4 rounded-xl font-bold transition-all ${isBetDisabled ? 'opacity-50 cursor-not-allowed' : 'hover:opacity-90 active:scale-95'}`,
                            onClick: () => !isBetDisabled && onBet(round.id, 'down'),
                            disabled: isBetDisabled
                        },
                            React.createElement('div', { className: "text-lg" }, t.betButtons.enterDown),
                            React.createElement('div', { className: "text-sm opacity-90 mt-1" }, `${payouts.payoutDown}x ${t.betButtons.payout}`)
                        )
                    )
                );
            };
            
            // LATER —Ä–∞—É–Ω–¥
            const renderLaterRound = () => {
                const startTime = new Date(round.startTime);
                const hours = startTime.getHours().toString().padStart(2, '0');
                const minutes = startTime.getMinutes().toString().padStart(2, '0');
                
                return React.createElement('div', { className: "p-4" },
                    // –ù–æ–º–µ—Ä –∏ —Å—Ç–∞—Ç—É—Å
                    React.createElement('div', { className: "flex justify-between items-center mb-4" },
                        React.createElement('div', null,
                            React.createElement('div', { className: "text-lg font-semibold text-white" }, `#${round.id}`),
                            React.createElement('div', { className: "text-sm text-muted" }, `${currentPair}/USD`)
                        ),
                        React.createElement('div', { className: "later-badge-telegram text-xs font-bold px-3 py-1.5 rounded-full" }, t.roundStatus.later)
                    ),
                    
                    // –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
                    React.createElement('div', { className: "text-center py-8" },
                        React.createElement('div', { className: "text-sm text-muted mb-2" }, t.betButtons.entryStarts),
                        React.createElement('div', { className: "text-2xl font-bold text-white" },
                            `~${hours}:${minutes}`
                        )
                    ),
                    
                    // –ü—É—Å—Ç—ã–µ –∫–Ω–æ–ø–∫–∏
                    React.createElement('div', { className: "flex gap-3 opacity-50" },
                        React.createElement('div', { className: "flex-1 up-button-telegram text-white py-4 rounded-xl font-bold text-center" },
                            React.createElement('div', null, t.betButtons.up),
                            React.createElement('div', { className: "text-sm opacity-90 mt-1" }, `~x ${t.betButtons.payout}`)
                        ),
                        React.createElement('div', { className: "flex-1 down-button-telegram text-white py-4 rounded-xl font-bold text-center" },
                            React.createElement('div', null, t.betButtons.down),
                            React.createElement('div', { className: "text-sm opacity-90 mt-1" }, `~x ${t.betButtons.payout}`)
                        )
                    )
                );
            };
            
            return React.createElement('div', {
                className: `telegram-card cursor-pointer transition-all duration-200 ${isSelected ? 'ring-2 ring-blue-500 ring-opacity-30' : ''}`,
                onClick: onSelect
            }, renderContent());
        }
        
        // –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function App() {
            const [rounds, setRounds] = useState([]);
            const [selectedRound, setSelectedRound] = useState(null);
            const [selectedPair, setSelectedPair] = useState('TON');
            const [balance, setBalance] = useState(50.75);
            const [betModal, setBetModal] = useState({ open: false, round: null, side: null });
            const [loading, setLoading] = useState(true);
            const [userBets, setUserBets] = useState([]);
            const [language, setLanguage] = useState('en');
            const [prices, setPrices] = useState({
                BTC: 89188.74,
                ETH: 2950.49,
                BNB: 886.87,
                TON: 6.85 // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ü–µ–Ω–∞ TON (~$6.85)
            });
            
            // –¢–µ–∫—É—â–∏–π –ø–µ—Ä–µ–≤–æ–¥
            const t = TRANSLATIONS[language];
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã
            const generateRounds = useCallback((pair) => {
                const now = Date.now();
                const basePrice = prices[pair];
                const roundsData = [];
                
                // PREV —Ä–∞—É–Ω–¥—ã (–ø—Ä–æ—à–ª—ã–µ) - –ó–ê–ú–û–†–û–ñ–ï–ù–ù–´–ï
                for (let i = 3; i > 0; i--) {
                    const lockedPrice = basePrice * (0.995 + Math.random() * 0.01);
                    const change = (Math.random() - 0.5) * 0.02;
                    const closedPrice = lockedPrice + (lockedPrice * change);
                    const isUp = change >= 0;
                    const prizePoolUp = isUp ? 0.3 + Math.random() * 1 : 0.1 + Math.random() * 0.5;
                    const prizePoolDown = !isUp ? 0.3 + Math.random() * 1 : 0.1 + Math.random() * 0.5;
                    const prizePool = prizePoolUp + prizePoolDown;
                    
                    roundsData.push({
                        id: CONFIG.INITIAL_ROUND_ID - i,
                        status: 'prev',
                        lockedPrice: lockedPrice,
                        closedPrice: closedPrice,
                        prizePool: prizePool,
                        prizePoolUp: prizePoolUp,
                        prizePoolDown: prizePoolDown,
                        frozenPayoutUp: (prizePool / prizePoolUp * (1 - CONFIG.COMMISSION)).toFixed(2),
                        frozenPayoutDown: (prizePool / prizePoolDown * (1 - CONFIG.COMMISSION)).toFixed(2),
                        startTime: now - (i + 2) * CONFIG.ROUND_DURATION * 1000,
                        endTime: now - (i + 1) * CONFIG.ROUND_DURATION * 1000
                    });
                }
                
                // LIVE —Ä–∞—É–Ω–¥
                const liveLockedPrice = basePrice * (0.998 + Math.random() * 0.004);
                roundsData.push({
                    id: CONFIG.INITIAL_ROUND_ID,
                    status: 'live',
                    lockedPrice: liveLockedPrice,
                    currentPrice: liveLockedPrice * (0.999 + Math.random() * 0.002),
                    prizePool: 0.8912,
                    prizePoolUp: 0.3712,
                    prizePoolDown: 0.52,
                    startTime: now - 60000, // –Ω–∞—á–∞–ª—Å—è 1 –º–∏–Ω—É—Ç—É –Ω–∞–∑–∞–¥
                    endTime: now + (CONFIG.ROUND_DURATION * 1000 - 60000) // –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è —á–µ—Ä–µ–∑ 4:59
                });
                
                // NEXT —Ä–∞—É–Ω–¥
                roundsData.push({
                    id: CONFIG.INITIAL_ROUND_ID + 1,
                    status: 'next',
                    prizePool: 0.0223,
                    prizePoolUp: 0.0093,
                    prizePoolDown: 0.013,
                    startTime: now + CONFIG.ROUND_DURATION * 1000,
                    entryEndTime: now + CONFIG.ROUND_DURATION * 1000 + CONFIG.ENTRY_DURATION * 1000
                });
                
                // LATER —Ä–∞—É–Ω–¥—ã
                for (let i = 2; i <= 4; i++) {
                    roundsData.push({
                        id: CONFIG.INITIAL_ROUND_ID + i,
                        status: 'later',
                        prizePool: 0,
                        prizePoolUp: 0,
                        prizePoolDown: 0,
                        startTime: now + i * CONFIG.ROUND_DURATION * 1000
                    });
                }
                
                return roundsData;
            }, [prices]);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
            useEffect(() => {
                const updatePrices = () => {
                    setPrices(prev => ({
                        BTC: Math.max(80000, prev.BTC * (1 + (Math.random() - 0.5) * 0.001)),
                        ETH: Math.max(2500, prev.ETH * (1 + (Math.random() - 0.5) * 0.002)),
                        BNB: Math.max(800, prev.BNB * (1 + (Math.random() - 0.5) * 0.003)),
                        TON: Math.max(5, prev.TON * (1 + (Math.random() - 0.5) * 0.005)) // TON ~$5-7
                    }));
                };
                
                updatePrices();
                const priceInterval = setInterval(updatePrices, 3000);
                return () => clearInterval(priceInterval);
            }, []);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            useEffect(() => {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
                const tg = window.Telegram?.WebApp;
                if (tg) {
                    tg.expand();
                    tg.setHeaderColor('#1c1c1e');
                    tg.setBackgroundColor('#1c1c1e');
                    
                    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ Telegram
                    const userLanguage = tg.initDataUnsafe?.user?.language_code || 'en';
                    if (userLanguage.startsWith('ru')) {
                        setLanguage('ru');
                    }
                }
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                setTimeout(() => {
                    setRounds(generateRounds(selectedPair));
                    setSelectedRound(CONFIG.INITIAL_ROUND_ID + 1);
                    setLoading(false);
                }, 500);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω LIVE —Ä–∞—É–Ω–¥–æ–≤
                const livePriceInterval = setInterval(() => {
                    setRounds(prev => prev.map(round => {
                        if (round.status === 'live' && round.currentPrice) {
                            const change = (Math.random() - 0.5) * 0.001;
                            return {
                                ...round,
                                currentPrice: round.currentPrice * (1 + change)
                            };
                        }
                        return round;
                    }));
                }, 2000);
                
                return () => clearInterval(livePriceInterval);
            }, [generateRounds, selectedPair]);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—É–Ω–¥–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä—ã
            useEffect(() => {
                if (!loading) {
                    setRounds(generateRounds(selectedPair));
                    setSelectedRound(CONFIG.INITIAL_ROUND_ID + 1);
                }
            }, [selectedPair, loading, generateRounds]);
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ LIVE –∏–ª–∏ NEXT —Ä–∞—É–Ω–¥–∞ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞
            const getTimerRound = useMemo(() => {
                const liveRound = rounds.find(r => r.status === 'live');
                const nextRound = rounds.find(r => r.status === 'next');
                return { liveRound, nextRound };
            }, [rounds]);
            
            // –í—Ä–µ–º—è –¥–ª—è —Ç–∞–π–º–µ—Ä–∞
            const timerTimeLeft = useMemo(() => {
                const now = Date.now();
                if (getTimerRound.liveRound) {
                    return Math.max(0, Math.floor((getTimerRound.liveRound.endTime - now) / 1000));
                } else if (getTimerRound.nextRound) {
                    return Math.max(0, Math.floor((getTimerRound.nextRound.entryEndTime - now) / 1000));
                }
                return CONFIG.ROUND_DURATION; // 5 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            }, [getTimerRound]);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ —Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞—É–Ω–¥–µ
            const hasBetInRound = (roundId) => {
                return userBets.some(bet => bet.roundId === roundId);
            };
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞–≤–∫–∏
            const handleBet = (roundId, side) => {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–∂–µ —Å–¥–µ–ª–∞–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É
                if (hasBetInRound(roundId)) {
                    alert(t.alerts.oneBetOnly);
                    return;
                }
                
                const round = rounds.find(r => r.id === roundId);
                if (round && round.status === 'next') {
                    setBetModal({ open: true, round, side });
                }
            };
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
            const confirmBet = (roundId, amount, side) => {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–∂–µ —Å–¥–µ–ª–∞–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É
                if (hasBetInRound(roundId)) {
                    alert(t.alerts.alreadyBet);
                    return;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—É–Ω–¥
                setRounds(prev => prev.map(round => {
                    if (round.id === roundId) {
                        const updatedRound = { ...round };
                        updatedRound.prizePool += amount;
                        
                        if (side === 'up') {
                            updatedRound.prizePoolUp += amount;
                        } else {
                            updatedRound.prizePoolDown += amount;
                        }
                        
                        return updatedRound;
                    }
                    return round;
                }));
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞–≤–∫—É –≤ –∏—Å—Ç–æ—Ä–∏—é
                const newBet = {
                    roundId,
                    amount,
                    side,
                    pair: selectedPair,
                    timestamp: Date.now(),
                    finalResult: null, // –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞—É–Ω–¥–∞
                    won: false
                };
                setUserBets(prev => [...prev, newBet]);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                setBalance(prev => prev - amount);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const alertMessage = `${t.alerts.betPlaced} ${amount} ${selectedPair} on ${side.toUpperCase()}`;
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.showAlert(alertMessage);
                } else {
                    alert(alertMessage);
                }
                
                setBetModal({ open: false, round: null, side: null });
            };
            
            // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞ (–¥–ª—è –¥–µ–º–æ)
            useEffect(() => {
                const checkRoundCompletion = () => {
                    const now = Date.now();
                    
                    setRounds(prev => prev.map(round => {
                        if (round.status === 'live' && round.endTime <= now) {
                            // –†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è
                            const closedPrice = round.currentPrice || round.lockedPrice;
                            const isUp = closedPrice >= round.lockedPrice;
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                            setUserBets(prevBets => prevBets.map(bet => {
                                if (bet.roundId === round.id) {
                                    const won = (bet.side === 'up' && isUp) || (bet.side === 'down' && !isUp);
                                    return {
                                        ...bet,
                                        finalResult: isUp ? 'up' : 'down',
                                        won: won
                                    };
                                }
                                return bet;
                            }));
                            
                            // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º LIVE –≤ PREV
                            return {
                                ...round,
                                status: 'prev',
                                closedPrice: closedPrice,
                                frozenPayoutUp: (round.prizePool / round.prizePoolUp * (1 - CONFIG.COMMISSION)).toFixed(2),
                                frozenPayoutDown: (round.prizePool / round.prizePoolDown * (1 - CONFIG.COMMISSION)).toFixed(2)
                            };
                        }
                        return round;
                    }));
                };
                
                const interval = setInterval(checkRoundCompletion, 1000);
                return () => clearInterval(interval);
            }, []);
            
            // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
            const addBalance = () => {
                const newBalance = balance + 100;
                setBalance(newBalance);
                
                const alertMessage = t.alerts.balanceAdded;
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.showAlert(alertMessage);
                } else {
                    alert(alertMessage);
                }
            };
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
            const toggleLanguage = () => {
                setLanguage(lang => lang === 'en' ? 'ru' : 'en');
            };
            
            // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞–≤–∫–∏
            const BetModal = ({ round, side, onClose, onConfirm, balance, hasUserBet }) => {
                const [amount, setAmount] = useState(CONFIG.MIN_BET.toString());
                const [quickAmounts] = useState([1, 5, 10, 25, 50, 100]);
                
                // –†–∞—Å—á–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞
                const potentialWin = useMemo(() => {
                    const betAmount = parseFloat(amount) || 0;
                    if (betAmount <= 0) return 0;
                    
                    if (side === 'up') {
                        const payout = round.prizePoolUp > 0 
                            ? (round.prizePool / round.prizePoolUp * (1 - CONFIG.COMMISSION))
                            : 1;
                        return betAmount * payout;
                    } else {
                        const payout = round.prizePoolDown > 0 
                            ? (round.prizePool / round.prizePoolDown * (1 - CONFIG.COMMISSION))
                            : 1;
                        return betAmount * payout;
                    }
                }, [amount, side, round]);
                
                const handleConfirm = () => {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–∂–µ —Å–¥–µ–ª–∞–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É
                    if (hasUserBet) {
                        alert(t.alerts.alreadyBet);
                        return;
                    }
                    
                    const betAmount = parseFloat(amount);
                    if (isNaN(betAmount) || betAmount < CONFIG.MIN_BET || betAmount > CONFIG.MAX_BET) {
                        alert(`${t.alerts.amountRange} ${CONFIG.MIN_BET} and ${CONFIG.MAX_BET} ${selectedPair}`);
                        return;
                    }
                    
                    if (betAmount > balance) {
                        alert(t.alerts.insufficientBalance);
                        return;
                    }
                    
                    onConfirm(round.id, betAmount, side);
                };
                
                return React.createElement('div', { className: "modal-overlay-telegram fixed inset-0 flex items-center justify-center z-50 p-4" },
                    React.createElement('div', { className: "telegram-card w-full max-w-sm" },
                        // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                        React.createElement('div', { className: "p-5 border-b border-white border-opacity-10" },
                            React.createElement('div', { className: "flex justify-between items-center" },
                                React.createElement('div', { className: "text-lg font-semibold text-white" }, `${t.betModal.title}${round.id}`),
                                React.createElement('button', { 
                                    onClick: onClose,
                                    className: "text-muted hover:text-white text-2xl"
                                }, "√ó")
                            ),
                            React.createElement('div', { className: `mt-3 text-xl font-bold ${side === 'up' ? 'text-price-up' : 'text-price-down'}` },
                                `${t.betModal.predict} ${side.toUpperCase()}`
                            ),
                            // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã
                            React.createElement('div', { className: "mt-2 text-sm text-muted" }, t.betModal.cantCancel)
                        ),
                        
                        // –°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏
                        React.createElement('div', { className: "p-5" },
                            React.createElement('div', { className: "mb-6" },
                                React.createElement('div', { className: "flex justify-between text-sm text-muted mb-3" },
                                    React.createElement('span', null, t.betModal.amount),
                                    React.createElement('span', null, `${t.betModal.balance}: ${balance.toFixed(2)} ${selectedPair}`)
                                ),
                                React.createElement('div', { className: "relative" },
                                    React.createElement('input', {
                                        type: "number",
                                        min: CONFIG.MIN_BET,
                                        max: Math.min(CONFIG.MAX_BET, balance),
                                        step: "0.1",
                                        value: amount,
                                        onChange: (e) => setAmount(e.target.value),
                                        className: "w-full p-5 text-3xl font-bold text-center bg-white bg-opacity-5 border border-white border-opacity-10 text-white rounded-xl focus:outline-none focus:border-blue-500",
                                        placeholder: "0.0"
                                    }),
                                    React.createElement('div', { className: "absolute right-4 top-1/2 transform -translate-y-1/2 text-muted font-medium" }, selectedPair)
                                )
                            ),
                            
                            // –ë—ã—Å—Ç—Ä—ã–µ —Å—É–º–º—ã
                            React.createElement('div', { className: "grid grid-cols-3 gap-3 mb-8" },
                                quickAmounts.map(quickAmount => 
                                    React.createElement('button', {
                                        key: quickAmount,
                                        className: `py-3 rounded-lg text-sm font-medium ${amount === quickAmount.toString() ? 'telegram-button text-white' : 'bg-white bg-opacity-5 text-white hover:bg-opacity-10'}`,
                                        onClick: () => setAmount(quickAmount.toString())
                                    }, `${quickAmount} ${selectedPair}`)
                                )
                            ),
                            
                            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–ª–∞—Ç–µ
                            React.createElement('div', { className: "bg-white bg-opacity-5 rounded-xl p-4 mb-8" },
                                React.createElement('div', { className: "flex justify-between text-sm mb-3" },
                                    React.createElement('span', { className: "text-muted" }, t.betModal.potentialPayout),
                                    React.createElement('span', { className: "font-bold text-white text-lg" }, `${potentialWin.toFixed(2)} ${selectedPair}`)
                                ),
                                React.createElement('div', { className: "flex justify-between text-sm" },
                                    React.createElement('span', { className: "text-muted" }, t.betButtons.payout),
                                    React.createElement('span', { className: "font-bold text-white" },
                                        side === 'up' 
                                            ? `${(round.prizePool / round.prizePoolUp * (1 - CONFIG.COMMISSION)).toFixed(2)}x`
                                            : `${(round.prizePool / round.prizePoolDown * (1 - CONFIG.COMMISSION)).toFixed(2)}x`
                                    )
                                )
                            ),
                            
                            // –ö–Ω–æ–ø–∫–∏
                            React.createElement('div', { className: "flex gap-4" },
                                React.createElement('button', {
                                    onClick: handleConfirm,
                                    className: `flex-1 py-4 rounded-xl font-bold text-white telegram-button hover:opacity-90 ${hasUserBet ? 'opacity-50 cursor-not-allowed' : ''}`,
                                    disabled: hasUserBet
                                }, t.betModal.confirm),
                                React.createElement('button', {
                                    onClick: onClose,
                                    className: "flex-1 py-4 bg-white bg-opacity-10 text-white rounded-xl font-bold hover:bg-opacity-20"
                                }, t.betModal.cancel)
                            )
                        )
                    )
                );
            };
            
            if (loading) {
                return React.createElement('div', { className: "min-h-screen flex items-center justify-center" },
                    React.createElement('div', { className: "text-center" },
                        React.createElement('div', { className: "animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4" }),
                        React.createElement('p', { className: "text-muted" }, t.loading)
                    )
                );
            }
            
            return React.createElement('div', { className: "min-h-screen pb-28 telegram-gradient-bg" },
                // –®–∞–ø–∫–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º –∏ —è–∑—ã–∫–æ–º
                React.createElement('header', { className: "px-4 pt-6 pb-4" },
                    React.createElement('div', { className: "flex justify-between items-center" },
                        React.createElement('div', null,
                            React.createElement('h1', { className: "text-2xl font-bold text-white" }, t.title),
                            React.createElement('p', { className: "text-sm text-muted mt-1" }, t.subtitle)
                        ),
                        React.createElement('div', { className: "text-right" },
                            React.createElement('div', { className: "text-xl font-bold text-white" }, `${balance.toFixed(2)} TON`),
                            React.createElement('div', { className: "text-xs text-muted" }, t.balance)
                        )
                    ),
                    // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞
                    React.createElement('div', { className: "mt-4 flex justify-end" },
                        React.createElement('button', {
                            onClick: toggleLanguage,
                            className: "text-sm bg-white bg-opacity-10 hover:bg-opacity-20 text-white px-4 py-2 rounded-full flex items-center gap-2 transition-all"
                        },
                            language === 'en' ? 'üá∑üá∫ –†—É—Å—Å–∫–∏–π' : 'üá∫üá∏ English'
                        )
                    )
                ),
                
                // –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø–∞—Ä—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ)
                React.createElement(PairsHeader, { 
                    prices: prices, 
                    selectedPair: selectedPair,
                    onSelectPair: setSelectedPair,
                    language: language 
                }),
                
                // –¢–∞–π–º–µ—Ä –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏ –∏ —Ä–∞—É–Ω–¥–∞–º–∏ (5 –º–∏–Ω—É—Ç)
                React.createElement(RoundTimer, { 
                    timeLeft: timerTimeLeft, 
                    t: t,
                    isLive: !!getTimerRound.liveRound 
                }),
                
                // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ —Ä–∞—É–Ω–¥–æ–≤
                React.createElement('main', { className: "px-4" },
                    React.createElement('div', { className: "scroll-container flex overflow-x-auto gap-4 pb-4 -mx-4 px-4" },
                        rounds.map(round => 
                            React.createElement('div', { 
                                key: round.id,
                                className: "flex-shrink-0 w-80"
                            },
                                React.createElement(PredictionCard, {
                                    round: round,
                                    onBet: handleBet,
                                    balance: balance,
                                    isSelected: selectedRound === round.id,
                                    onSelect: () => setSelectedRound(round.id),
                                    t: t,
                                    userBets: userBets.filter(bet => bet.pair === selectedPair),
                                    currentPair: selectedPair
                                })
                            )
                        )
                    )
                ),
                
                // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞–≤–∫–∏
                betModal.open && React.createElement(BetModal, {
                    round: betModal.round,
                    side: betModal.side,
                    balance: balance,
                    onClose: () => setBetModal({ open: false, round: null, side: null }),
                    onConfirm: confirmBet,
                    hasUserBet: hasBetInRound(betModal.round?.id)
                }),
                
                // –ö–Ω–æ–ø–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
                React.createElement('div', { className: "floating-bottom-telegram p-4" },
                    React.createElement('button', {
                        className: "w-full py-4 telegram-button text-white font-bold rounded-xl shadow-lg hover:opacity-90 active:scale-95 transition-all",
                        onClick: addBalance
                    },
                        React.createElement('div', { className: "flex items-center justify-center gap-3" },
                            React.createElement('div', { className: "text-2xl" }, "üíé"),
                            React.createElement('span', { className: "text-lg" }, t.addBalance)
                        )
                    )
                )
            );
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>